@model PegazusERP.DTO.PessoaDTO

@{
    var addEdit = Model.Id == 0 ? "Adicionar" : "Editar";
}

@Html.Partial("_Mensagens")
<div class="recipiente-pagina">

    <h4><i class="fa fa-edit"></i> @addEdit Pessoa</h4>

    @using (Ajax.BeginForm("POSTEditar", "Pessoa", new AjaxOptions { UpdateTargetId = "content", InsertionMode = InsertionMode.Replace, HttpMethod = "Post", OnFailure = "OnFailure", OnSuccess = "OnSuccess" }, new { @class = "smart-form" }))
    {
        @Html.ValidationSummary(true)
        @Html.AntiForgeryToken()
        @Html.HiddenFor(model => model.Id)

        <fieldset>
            <div class="row">
                <section class="col col-6">
                    <label for="Nome" class="label obrigatorio">Nome</label>
                    <label class="input">
                        @Html.TextBoxFor(model => model.Nome, new { maxlength = "128" })
                    </label>
                    @Html.ValidationMessageFor(model => model.Nome)
                </section>
                <section class="col col-3">
                    <label for="FisicaJuridica" class="label">Tipo</label>
                    <label class="select">
                        @Html.EnumDropDownListFor(model => model.FisicaJuridica)
                        <i></i>
                    </label>
                    @Html.ValidationMessageFor(model => model.FisicaJuridica)
                </section>
                <section class="col col-3">
                    <label for="TipoPessoa" class="label">Tipo Pessoa</label>
                    <label class="select">
                        @Html.EnumDropDownListFor(model => model.TipoPessoa, new { @class = "select2" })
                    </label>
                    @Html.ValidationMessageFor(model => model.TipoPessoa)
                </section>
            </div>
            <div id="divRazaoSocialCNPJ" style="display:none">
                <div class="row">
                    <section class="col col-6">
                        <label for="TipoPessoa" class="label">Razão Social</label>
                        <label class="input">
                            @Html.TextBoxFor(model => model.RazaoSocial)
                        </label>
                        @Html.ValidationMessageFor(model => model.RazaoSocial)
                    </section>
                    <section class="col col-6">
                        <label for="Cnpj" class="label">CNPJ</label>
                        <label class="input">
                            @Html.TextBoxFor(model => model.Cnpj, new { @class = "cnpj" })
                        </label>
                        @Html.ValidationMessageFor(model => model.Cnpj)
                    </section>
                </div>
            </div>
            <div class="row">
                <section class="col col-6">
                    <label for="Ie" class="label">I.E</label>
                    <label class="input">
                        @Html.TextBoxFor(model => model.Ie)
                    </label>
                    @Html.ValidationMessageFor(model => model.Ie)
                </section>
                <section class="col col-6">
                    <label for="Email" class="label">Email</label>
                    <label class="input">
                        @Html.TextBoxFor(model => model.Email)
                    </label>
                    @Html.ValidationMessageFor(model => model.Email)
                </section>
            </div>
            <div class="row">
                <section class="col col-6">
                    <label for="ObjetivoComercial" class="label">Obejtivo Comercial</label>
                    <label class="select">
                        @Html.EnumDropDownListFor(model => model.ObjetivoComercial)
                        <i></i>
                    </label>
                    @Html.ValidationMessageFor(model => model.ObjetivoComercial)
                </section>
                <section class="col col-6">
                    <label for="LimiteCredito" class="label">Limite de Crédito</label>
                    <label class="input">
                        @Html.TextBoxFor(model => model.LimiteCredito, new { @class = "valor" })
                        <i></i>
                    </label>
                    @Html.ValidationMessageFor(model => model.LimiteCredito)
                </section>
            </div>
            <div id="divVendedor" style="display:none">
                <section>
                    <label for="VendedorId" class="label">Vendedor</label>
                    <label class="input">
                        @Html.TextBoxFor(model => model.VendedorId)
                        <i></i>
                    </label>
                    @Html.ValidationMessageFor(model => model.VendedorId)
                </section>
            </div>
        </fieldset>
    <div id="divDadosPessoais" style="display:none">
        <fieldset>
            <legend>Dados Pessoais</legend>
            <div class="row">
                <section class="col col-6">
                    <label for="Cpf" class="label">CPF</label>
                    <label class="input">
                        @Html.TextBoxFor(model => model.Cpf, new { @class = "cpf" })
                    </label>
                    @Html.ValidationMessageFor(model => model.Cpf)
                </section>
                <section class="col col-3">
                    <label for="EstadoCivil" class="label">Estado Civil</label>
                    <label class="input">
                        @Html.TextBoxFor(model => model.EstadoCivil)
                    </label>
                    @Html.ValidationMessageFor(model => model.EstadoCivil)
                </section>
                <section class="col col-3">
                    <label for="Escolaridade" class="label">Data Nascimento</label>
                    <label class="input">
                        <i class="icon-append fa fa-calendar"></i>
                        @Html.TextBoxFor(model => model.DataNascimento, new Dictionary<string, Object> { { "class", "datepicker" }, { "data-dateformat", "dd/mm/yy" } })
                    </label>
                    @Html.ValidationMessageFor(model => model.DataNascimento)
                </section>
            </div>
            <div class="row">
                <section class="col col-3">
                    <label for="Ie" class="label">Sexo</label>
                    <label class="select">
                        @Html.EnumDropDownListFor(model => model.Sexo)
                        <i></i>
                    </label>
                    @Html.ValidationMessageFor(model => model.Sexo)
                </section>
                <section class="col col-3">
                    <label for="Nacionalidade" class="label">Nacionalidade</label>
                    <label class="input">
                        @Html.TextBoxFor(model => model.Nacionalidade)
                    </label>
                    @Html.ValidationMessageFor(model => model.Nacionalidade)
                </section>
                <section class="col col-3">
                    <label for="Profissao" class="label">Profissão</label>
                    <label class="input">
                        @Html.TextBoxFor(model => model.Profissao)
                    </label>
                    @Html.ValidationMessageFor(model => model.Profissao)
                </section>
                <section class="col col-3">
                    <label for="Escolaridade" class="label">Escolaridade</label>
                    <label class="input">
                        @Html.TextBoxFor(model => model.Escolaridade)
                    </label>
                    @Html.ValidationMessageFor(model => model.Escolaridade)
                </section>
            </div>
            <div class="row">
               
                <div id="divDadosVendedor" style="display:none">
                    <section class="col col-3">
                        <label for="PercentualPrazo" class="label">Percentual a Prazo</label>
                        <label class="input">
                            @Html.TextBoxFor(model => model.PercentualPrazo)
                        </label>
                        @Html.ValidationMessageFor(model => model.PercentualPrazo)
                    </section>
                    <section class="col col-3">
                        <label for="PercentualPrazo" class="label">Percentual a Vista</label>
                        <label class="input">
                            @Html.TextBoxFor(model => model.PercentualPrazo)
                        </label>
                        @Html.ValidationMessageFor(model => model.PercentualPrazo)
                    </section>
                </div>
            </div>

        </fieldset>
    </div>
        <ul id="tabPessoa" class="nav nav-tabs bordered">
            <li class="active">
                <a href="#s1" data-toggle="tab">Dados Básicos</a>
            </li>
            <li>
                <a href="#s2" data-toggle="tab">Endereço</a>
            </li>

            <li>
                <a href="#s3" data-toggle="tab">Contato</a>
            </li>

            <li>
                <a href="#s4" data-toggle="tab">Outros Documentos</a>
            </li>
        </ul>

        <div id="tabAlunoContent" class="tab-content padding-10">
            <div class="tab-pane fade in active" id="s1">
                <!--Dados Básicos-->
                <fieldset>
                    <div class="row">
                        <section class="col col-3">
                            <label class="label">&nbsp;</label>
                            <label class="checkbox">
                                @Html.CheckBoxFor(c => c.Ativo, false) Ativo
                                <i></i>
                            </label>
                        </section>
                        <section class="col col-3">
                            <label class="label">&nbsp;</label>
                            <label class="checkbox">
                                @Html.CheckBoxFor(c => c.CompraPrazo, false) Compra prazo
                                <i></i>
                            </label>
                        </section>
                        <section class="col col-3">
                            <label class="label">&nbsp;</label>
                            <label class="checkbox">
                                @Html.CheckBoxFor(c => c.SubISS, false) SubIss
                                <i></i>
                            </label>
                        </section>
                        <section class="col col-3">
                            <label class="label">&nbsp;</label>
                            <label class="checkbox">
                                @Html.CheckBoxFor(c => c.RetemImpostos, false) Retém Impostos
                                <i></i>
                            </label>
                        </section>
                    </div>

                </fieldset>
            </div>
            <div class="tab-pane fade in" id="s2">

                <fieldset>
                    <footer>
                        @if (Model.Id > 0)
                        {
                            <button type="button" class="btn btn-primary" onclick="CarregarPaginaAjax('/Aluno/Responsavel?alunoId=@Model.Id&responsavelId=0')"><i class="fa fa-plus"></i> Adicionar</button>
                        }
                    </footer>
                    <table class="table table-striped table-hover table-condensed table-row-link" id="gridResponsavel">
                        <thead>
                            <tr>
                                <th>Logradouro</th>
                                <th>Número</th>
                                <th>Bairro</th>
                                <th>Cidade</th>
                                <th>CEP</th>
                            </tr>
                        </thead>
                        @*@if (Model.Responsaveis != null)
                            {
                                foreach (var responsavel in Model.Responsaveis)
                                {
                                    <tr>
                                        <td data-alunoid="@Model.Id" data-responsavelid="@responsavel.Id">@responsavel.PessoaNome</td>
                                        <td>
                                            @if (responsavel.NivelParentesco == eParentesco.Outro && !string.IsNullOrWhiteSpace(responsavel.Parentesco))
                                            {
                                                @responsavel.Parentesco
                                            }
                                            else
                                            {
                                                @Function.GetEnumDescription(responsavel.NivelParentesco)
                                            }
                                        </td>
                                        <td>@responsavel.PessoaTelefone</td>
                                        <td>@responsavel.PessoaCelular</td>
                                    </tr>
                                }
                            }*@
                    </table>
                </fieldset>
            </div>
            <div class="tab-pane fade in" id="s3">
                <fieldset>
                    <footer>
                        @if (Model.Id > 0)
                        {
                            <button type="button" class="btn btn-primary" onclick="CarregarPaginaAjax('/Aluno/Responsavel?alunoId=@Model.Id&responsavelId=0')"><i class="fa fa-plus"></i> Adicionar</button>
                        }
                    </footer>
                    <table class="table table-striped table-hover table-condensed table-row-link" id="gridResponsavel">
                        <thead>
                            <tr>
                                <th>Número</th>
                                <th>Tipo</th>
                            </tr>
                        </thead>
                        @*@if (Model.Responsaveis != null)
                            {
                                foreach (var responsavel in Model.Responsaveis)
                                {
                                    <tr>
                                        <td data-alunoid="@Model.Id" data-responsavelid="@responsavel.Id">@responsavel.PessoaNome</td>
                                        <td>
                                            @if (responsavel.NivelParentesco == eParentesco.Outro && !string.IsNullOrWhiteSpace(responsavel.Parentesco))
                                            {
                                                @responsavel.Parentesco
                                            }
                                            else
                                            {
                                                @Function.GetEnumDescription(responsavel.NivelParentesco)
                                            }
                                        </td>
                                        <td>@responsavel.PessoaTelefone</td>
                                        <td>@responsavel.PessoaCelular</td>
                                    </tr>
                                }
                            }*@
                    </table>
                </fieldset>
            </div>
            <div class="tab-pane fade in active" id="s4">
                <!--Dados Básicos-->
                <fieldset></fieldset>
            </div>
        </div>

        <footer>
            <button type="submit" class="btn btn-primary" data-loading-text="Salvando..."><i class="fa fa-save"></i> Salvar</button>
            @if (Model.Id > 0)
            {
                <button type="button" class="btn btn-danger" id="btn_excluir"><i class="fa fa-trash-o"></i> Excluir</button>
            }
            <button type="button" class="btn btn-default" onclick="CarregarPaginaAjax('@Url.Action("Index", "Pessoa")')"><i class="fa fa-arrow-left"></i> Voltar</button>
        </footer>
    }

</div>

<script src="@Url.Content("~/Scripts/modulos/pessoaEditar.js")" type="text/javascript"></script>

<script type="text/javascript">
    $("#FisicaJuridica").change(function () {
        if ($(this).val() == "0") {
            $("#divDadosPessoais").show();
            $("#divRazaoSocialCNPJ").hide();
        }
        else if ($(this).val() == "1")
        {
            $("#divDadosPessoais").hide();
            $("#divRazaoSocialCNPJ").show();
        }
    });

    $("#TipoPessoa").change(function () {
        if ($(this).val()=="0") {
            $("#divVendedor").show();
        } else if ($(this).val() == "2") {
            $("#divDadosVendedor").show();
        }
        else {
            $("#divDadosVendedor").hide();
        }
    });


</script>

